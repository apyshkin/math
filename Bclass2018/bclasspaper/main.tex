\documentclass[12pt]{amsart}
\input{preamble}
\usepackage{caption}
\usepackage{tikz}
\usepackage{tkz-berge}
\usetikzlibrary{positioning, chains, fit, shapes, calc}
        \tikzset{lnode/.style={auto, circle, draw,fill=gray!50},
                 rnode/.style={auto, circle, draw},
                 mnode/.style={auto, circle, draw, fill=gray!25},
                 wnode/.style={sloped,above}}

\begin{document}
  \title{Rank one density property for a class of $M$-bases}
  \author{Alexey Pyshkin}
  \begin{abstract}
    In~\cite{azoff} Azoff and Shehada introduced a strong $M$-basis that did not admit a linear summation method.
    We study a class of $M$-bases $\mathfrak{F}=\{f_n\}_{n=1}^\infty$ in the Hilbert space, which
      represents a generalisation of the Larson--Wogen system.
    We determine the conditions under which $\mathfrak{F}$ admits a linear summation method, moreover
      we investigate the two point density property for $\mathfrak{F}$.
    In order to do that we employ some of the graph theory techniques.
  \end{abstract}
  \maketitle

\section{Introduction}
  Consider a $M$-basis $\fsys = \seq{f}$ in the Hilbert space $\cal{H}$.
  Let $\cal{F}$ be a subspace lattice generated from $\fsys$ and $\cal{A}$ be an operator algebra leaving all the elements of
    $\cal{F}$ invariant.
    %Let $\cal{A}$ be a reflexive algebra of bounded operators acting on the Hilbert space $\cal{H}$
    %  and $\cal{F} = \operatorname{Lat}(\cal{A})$ be the corresponding lattice of invariant subspaces.
  We are interested in the following three properties of the algebra $\cal{A}$.
  \begin{definition}[one point density property]
    \label{1pd}
    We say that $\fsys$ is \emph{one point dense} if for any $x \in \cal{H}$ for any $\epsilon > 0$
      there exists such $T\in \cal{A}$ that $||T(x) - x|| < \epsilon$.

    % The algebra $\cal{A} is \emph{strongly reflexive} if ...
    % The lattice $\cal{F}$ is \emph{completely distributive} if ...
  \end{definition}
  \begin{note}
    The definition is equivalent to $\fsys$ being a strong $M$-basis. (see~\cite{katavolos})
  \end{note}
  \begin{definition}[two point density property]
    \label{2pd}
    We say that $\fsys$ is \emph{two point dense} if for any $x, y \in \cal{H}$ for any $\epsilon > 0$
      there exists such $T\in \cal{A}$ that $||T(x) - x|| < \epsilon$ and $||T(y) - y|| < \epsilon$.
  \end{definition}
  \begin{definition}[rank one density property]
    \label{r1d}
    We say that the algebra $\cal{A}$ possesses \emph{rank one density property} if
      the rank one subalgebra $R_1(\cal{A}) \subset \cal{A}$ is dense in $\cal{A}$ in the strong operator topology.
  \end{definition}
  \begin{note}
    The last definition is equivalent to the existence of the \emph{linear summation method} for $\fsys$.
  \end{note}
  Notice that we always have $\ref{r1d} \Rightarrow \ref{2pd} \Rightarrow \ref{1pd}$.
  But is it true that $\ref{1pd} \Rightarrow \ref{r1d}$ or that $\ref{2pd} \Rightarrow \ref{r1d}$?
  This paper is devoted to the study of the second question.

  Actually, the first question has some history.
  Longstaff in~\cite{longstaff} studied the abstract subspace lattices and the corresponding operator algebras.
  Particularly, Longstaff proved that the rank one density property implies
    the complete distributivity of its lattice (see Raney~\cite{raney} for a definition).
  It is now a well-known fact that for a subspace lattice generated from an $M$-basis the complete distributivity of its lattice is equivalent to
    the property~\ref{1pd} (see~\cite{argyroslambrou} for a proof).
  In the same paper the following question was raised: does the complete distributivity of $\cal{F}$ imply the rank one density property?
  The answer was already known to be positive in the case of a totally ordered lattice~\cite{erdos}, and
    Longstaff proved that for a finite-dimensional Hilbert space in~\cite{longstaff}.
  Later Laurie and Longstaff discovered that the rank one density holds in the case of commutative subspace lattices~\cite{laurielongstaff}.

  However the solution for the general case remained unknown until Larson and Wogen determined that the answer is negative (see~\cite{larson}).
  They managed to build an example of such a vector system $\fsys$ that the lattice $\cal{F}$ generated from $\fsys$
    was completely distributive, but the corresponding algebra $\cal{A}$
    did not possess the rank one density property (see Example~\ref{lw-sys}).
  This example was also studied in the paper~\cite{argyroslambrou} (see Addendum) and by Azoff and Shehada in~\cite{azoff} regarding
    the reflexivity of the lattice $\cal{F}$.
  Finally Katavolos et al. in the paper~\cite{katavolos} performed a deep analysis of the density properties of this vector system and
    deduced that for this system the property~\ref{1pd} holds while~\ref{r1d}.
  We refer to this example as to Larson--Wogen vector system in this paper.

  We are eager to understand whether the two point density always implies the rank one density property or is there a counterexample.

  In the next sections we are going to study the specific class of vector systems which represents a natural generalisation of
    the Larson--Wogen vector system.
  We are going to analyze the properties~\ref{1pd},~\ref{2pd} and~\ref{r1d} for this class.
  \begin{example}[Larson--Wogen system $\fsys_{LW}$]
    \label{lw-sys}
    \begin{align*}
      &f_1 = e_1 + a_2 e_2, \qquad &f_{2j}=e_{2j}, \quad&j \geq 1,&\\
      &f_{2j-1}=-a_{2j-1}e_{2j-2} + e_{2j-1} + a_{2j}e_{2j}, \qquad &\makebox[5em]{} \quad&j \geq 2,&\\
      &f^*_{2j}=-a_{2j}e_{2j-1}+e_{2j}+a_{2j+1}e_{2j+1}, \qquad &f^*_{2j-1}=e_{2j-1}, \quad&j \geq 1&
    \end{align*}
  \end{example}

\section{B-class of vector systems: linear summation problem}
    \label{fsys2graphs}
    The Hilbert space $\cal{H}$ is presumed to have infinite dimension.
    Consider a complete minimal vector system $\fsys = \seq{f}$ in the Hilbert space $\cal{H}$.
    The sequence is called \emph{minimal} if none of its elements can be approximated by the linear combinations of the others.
    The system $\fsys$ is minimal when and only when it possesses a unique biorthogonal system $\fstarsys$.
    We say that $\fsys$ is an $M$-basis if $\fstarsys$ is complete as well.
    It is called a strong $M$-basis if for any $x\in\cal{H}$ we have $x \in \overline{span}(\inner{x}{f^*_k}f_k)$, where
      $\overline{span}$ denotes a closed linear span.
    The system $\fsys$ admits a linear summation method if there is a doubly indexed sequence $\alpha_{kn}$ if
      $\lim_{n \to \infty} \sum_k \alpha_{kn} \inner{x}{f^*_k}f_k = x$ for any $x \in \cal{H}$.
    As we already mentioned the linear summation method existence is equivalent to the property~\ref{r1d}.
    We are interested in the density properties~\ref{2pd} and~\ref{r1d} of the vector system $\fsys = \seq{f}$
      in a separable real Hilbert space $\cal{H}$. \alex{todo complex}
    Suppose that $\cal{H}$ has an orthonormal basis $\seq{e}$.
    Let $\fstarsys = \{f_n^{*}\}_{n=1}^\infty$ be a biorthogonal vector system to the original system $\seq{f}$.
    \begin{definition}
      The vector system $\fsys$ belongs to the \emph{B-class} whenever the following conditions are satisfied:
      \begin{enumerate}[label=\textbf{C\arabic*}]
        \item \label{c1} both $\fsys$ and $\fstarsys$ are complete (or $\fsys$ is $M$-basis)
        \item \label{c2} either $f_n = e_n$ or $f^*_n = e_n$ for any $n > 0$,
        \item \label{c3} $\inner{f_n}{e_n} = \inner{f^*_n}{e_n} = 1$ for any $n > 0$,
        \item \label{c4} $\inner{f_n}{e_k} = -\inner{f^*_k}{e_n}$ for any $n, k > 0; n \neq k$,
        \item \label{c5} the matrices $\{\inner{f_n}{e_k}\}$ and $\{\inner{f^*_n}{e_k}\}$ are both finite-band.
      \end{enumerate}
    \end{definition}
    \begin{prop}
      The definition given above guarantees the biorthogonality of the $f_n$ and $f^*_n$.
    \end{prop}
    \begin{proof}
      Consider the set of indices $N = \left\{n \in \mathbb{N} \mid f_n = e_n \right\}$.
      The property~\ref{c4} yields that $\inner{f_n}{e_k}$ is equal to zero whenever $k$ is not in
        $\mathbb{N} \cup {n}$.
      Similarly $f^*_m$ is orthogonal to $e_k$ for all $k$ in $\mathbb{N} \setminus {m}$.
      We also have
      \[
        \inner{f_n}{f^*_m} = \sum_{k} \inner{f_n}{e_k} \inner{e_k}{f^*_m}.
      \]
      It follows from above that each summand on the right side is equal to zero whenever $k \neq n, m$.
      Thus we get
      \[
        \inner{f_n}{f^*_m} = \inner{f_n}{e_n} \inner{e_n}{f^*_m} + \inner{f_n}{e_m} \inner{e_m}{f^*_m}
        = \inner{e_n}{f^*_m} + \inner{f_n}{e_m} = 0,
      \]
      if $n \neq m$.
      Otherwise if $n = m$ we get $\inner{f_n}{f^*_m} = 1$ due to the conditions~\ref{c2} and~\ref{c3}.
    \end{proof}
    The B-class of vector systems is the main subject of this section.
    It is a natural extension of the Larson--Wogen system (see Ex.~\ref{lw-sys}).
    B-class has an interesting property we are going to exploit later.
    \begin{remark}
      A vector system which belongs to the B-class could be associated with an
        locally-finite weighted bipartite graph $B(\fsys) = (V, E, \wt)$, where $\wt$ is a
        real-valued function on $V\times V$ such that $\wt(v, u) = -\wt(u, v)$.
      For each index $l > 0$ such that $f^*_l = e_l$ we put a vertex $v_l$ in the first part of the bipartite graph.
      We will call this part from now on the \emph{left} part of the graph $B(\fsys)$.
      For any other index $r > 0$ we construct a vertex in the other part of the graph.
      Evidently, for such indices $r > 0$ the condition $f_r = e_r$ holds due to the definition of the B-class vector systems.
      The second part of the graph will be referred as the \emph{right} part of the graph $B(\fsys)$.
      We put an edge between two vertices $v_l$ and $v_r$ from the left and right parts respectively,
        whenever the scalar product $\inner{f_l}{e_r}$ is not zero.
      For such two vertices we have $\inner{f_l}{e_r}$ = $-\inner{f_r}{e_l}$.
      Denote by $\wt_{lr}$ the expression $\wt_{lr} = \inner{f_l}{e_r}^{-1}$.
      Obviously $\wt_{lr} = -\wt_{rl}$.
      Since the Hilbert space is infinite-dimensional the graph is infinite as well.
      However due to the finite-band condition~\ref{c5} the vertices of the graph are of a finite degree, hence the locally-finiteness of
        the constructed graph.
    \end{remark}
    \begin{remark}
      Note that there might be several vector systems for a single weighted bipartite graph $B$.
    \end{remark}
    \begin{remark}
      Observe that due to the condition~\ref{c1} both parts of the bipartite graph must
        contain an infinite number of vertices.
    \end{remark}
    \begin{figure}
      \begin{center}
      \begin{tikzpicture}[thick,
                          every node/.style={draw},
                          %every fit/.style={ellipse,draw,inner sep=-1pt,text width=1cm},
                          ]

        \begin{scope}[start chain=going below,node distance=12mm]
          \foreach [evaluate={\k=int(\i*2 + 1)}] \i in {0,...,3}
          \node[lnode,on chain] (l\k) [label=left: $v_{l_\k}$] {$e_{\k}$};
          \node[draw=none,on chain, yshift=7mm]{$\vdots$};
        \end{scope}
        \begin{scope}[xshift=4cm,yshift=-0.7cm,start chain=going below,node distance=12mm]
          \foreach [evaluate={\k=int(\i*2 + 2)}] \i in {0,...,3}
          \node[rnode,on chain] (r\k) [label=right: $v_{r_\k}$] {$e_\k$};
          \node[draw=none,on chain, yshift=7mm]{$\vdots$};
        \end{scope}

        % the set U
        %\node [fit=(l1) (l5),label=above:\emph{left}] {};
        % the set V
        %\node [fit=(r6) (r9),label=above:\emph{right}] {};

        % the edges
        \begin{scope}[wnode]
          \foreach [evaluate={\l=int(\i*2 + 1);\r=int(\i*2 + 2)}] \i in {0,...,3}
          \draw (l\l) to node[draw=none, color=black] {\footnotesize $w_{\l\r}=a_{\r}$} (r\r);
          \foreach [evaluate={\l=int(\i*2 + 3);\r=int(\i*2 + 2)}] \i in {0,...,2}
          \draw (l\l) to node[draw=none,color=black] {\footnotesize $w_{\r\l}=a_{\l}$} (r\r);
        \end{scope}
      \end{tikzpicture}
      \caption{The bipartite graph $B(\fsys_{LW})$ } \label{lw-bgraph}
      \end{center}
    \end{figure}

    You can see the bipartite graph built from the Larson--Wogen system on the Figure~\ref{lw-bgraph}.

    \subsection{Linear summation method for B-class}
    Suppose we have a B-class vector system $\fsys=\seq{f}$.
    Our purpose is to analyze the two point density property of $\fsys$.
    Before we pursue that, we need to investigate the conditions under which the B-class system admits a linear summation method.
    First of all we intend to demonstrate a reformulation of the linear summation method existence problem for
      the B-class vector systems in terms of infinite networks.

    Recall that there exists a linear summation method for the system $\seq{f}$
      if and only if there is no trace class operator $T: \cal{H} \to \cal{H}$ with the trace equal to $1$,
      such that $\inner{Tf_n}{f_n^*} = 0$ for any $n$.
    Suppose that there is an operator $T$ such that $\inner{Tf_n}{f_n^*} = 0$ for any $n$.
    There are two cases: either $f^*_n = e_n$ or $f_n = e_n$.
    In the first case the condition $\inner{Tf_n}{f_n^*} = 0$ turns into
    \begin{equation}
        \label{left-eqn}
        \sum_j T_{nj} \inner{f_n}{e_j} = 0,
    \end{equation}
    and in the second case it is equivalent to
    \begin{equation}
        \label{right-eqn}
        \sum_j T_{jn} \inner{f^*_n}{e_j} = 0.
    \end{equation}
    Now consider an auxiliary function $\flowsgn: V \otimes V \to \mathbb{R}$ defined as follows
    \begin{align*}
        &\flowsgn(v_l, v_r) = T_{lr} \inner{f_l}{e_r} = T_{lr} \wt_{lr}^{-1},\\
        &\flowsgn(v_r, v_l) = T_{lr} \inner{f^*_r}{e_l} = T_{lr} \wt_{rl}^{-1}.
    \end{align*}
    Observe that $\flowsgn$ is a skew-symmetric function.
    Moreover, two equalities~\eqref{left-eqn} and~\eqref{right-eqn} correspond to the \emph{left} and \emph{right}
      parts of the bipartite graph $B(\fsys)$ respectively.
    It follows that the condition $\inner{Tf_n}{f_n^*} = 0$ could be reduced to the simpler one:
    \begin{equation}
      \label{almost-flow-eqn}
      \sum_{u \in V} \flowsgn(v, u) + T_{vv} = 0
    \end{equation}
      for each vertex $v$ in the graph $B(\fsys)$.
    \begin{remark}
      Notice how the function $\flowsgn$ defined on the graph $B(\fsys)$ resembles
        a \emph{flow} defined on the edges of the $B(\fsys)$ graph.
      One might also see that the equation~\eqref{almost-flow-eqn} describes the total flow (sum of the outgoing flow and incoming flow) 
        for each vertex $v$ in the graph $B(\fsys)$.
      In order to formalize this observation we are going to build a flow function
        after a few changes are made to the graph $B(\fsys)$.
    \end{remark}
    Before we proceed we are going to introduce a few basic definitions.
    \begin{definition}
        \emph{Network} $\net$ is a quadruple $(G, \wtp, \source, \sink)$, where $G = (V, E)$ is weighted graph
        with a positive length function $\wtp$ on $E$ and two vertices $\source, \sink \in V$, which
        we will call \emph{source} and \emph{sink} of the network respectively.
    \end{definition}
    \begin{definition}
        The skew-symmetric function $\flow: V \times V \to \mathbb{R}$ is called a \emph{pseudo-flow}.
    \end{definition}
    \begin{definition}
      Let $G = (V, \vec{E})$ be an oriented graph.
      For each vertex $v \in V$ we take $\ein(v)$ as the set of incoming edges
      and $\eout(v)$ as the set of outgoing edges in the graph $G$.
      For the set of vertices $V_0$ we denote
      \begin{align*}
        &\ein(V_0) = \big\{\ein(v) \mid v\in V_0\big\},\\
        &\eout(V_0) = \big\{\eout(v) \mid v\in V_0\big\}.
      \end{align*}
      For the subgraph $G_0 = (V_0, E_0) \subseteq G$ we use the same notation
      \begin{align*}
        &\ein(G_0) = \big\{(uv)\in E_0 \mid u \in V \setminus V_0, v \in V_0\big\},\\
        &\eout(G_0) = \big\{(vu) \in E_0 \mid u \in V\setminus V_0, v \in V_0\big\}.
      \end{align*}
      For each edge $e=(uv) \in \vec{E}$ we are going to denote %by $\init(e)$ the starting vertex $u$ and
        by $\ter(e)$ the ending vertex $v$.
      For the set of edges $E_0$ we denote
      \begin{align*}
        %&\init(E_0) = \big\{\init(e) \mid e\in E_0\big\},\\
        &\ter(E_0) = \big\{\ter(e) \mid e\in E_0\big\}.
      \end{align*}
    \end{definition}
    \begin{definition}
      Let $\net = (G, \wtp, \source, \sink)$ be a network, and $\flow$ be a pseudo-flow function.
      Also denote by $d_{+}(v)$ the sum of the flows \emph{leaving} the vertex $v$ and by
      $d^{-}(v)$ the sum of the flows \emph{entering} $v$:
      \begin{align*}
        &d^{+}_{\flow}(v) = \sum_{\flow(vu) > 0} \flow(vu),\\
        &d^{-}_{\flow}(v) = \sum_{\flow(uv) > 0} \flow(uv).
      \end{align*}
      Also let $d_{\flow}(v)$ be equal to $d^{+}_{\flow}(v) - d^{-}_{\flow}(v)$.
      Sometimes we will refer to this value as a \emph{total flow} of the vertex $v$.
      The vertex is called \emph{$\flow$-active} if $d(v)$ is less than zero,
      \emph{$\flow$-deficient} if $d(v)$ is greater than zero and
      \emph{$\flow$-preserving} if $d(v)$ is precisely zero, meaning that the total incoming flow
      is equal to the total outgoing flow of the vertex $v$.
    \end{definition}
    \begin{definition}
      Given a network $\net = (V, E, \wtp, \source, \sink)$ and a pseudo-flow function $\flow$ we will name $\flow$ a
        \emph{flow} function if for any vertex $v \in V \setminus \{\source, \sink\}$ the total flow is zero: $d(v) = 0$.
    \end{definition}
    \begin{definition}
      For a network $\net = (G, \wtp, \source, \sink)$ and a flow $\flow$ we will say,
      that the flow $\flow$ is \emph{$\flow$-preserving} if $d(\sink) = -d(\source)$.
    \end{definition}
    \begin{note}
      In simple words this property suggests
        that the total flow coming out of the source is equal to the total flow
        coming into the sink.
    \end{note}
    \begin{definition}
      \emph{Oriented network} $\onet$ is a quadruple $(\vec{G}, \wtp, \source, \sink)$, where
        $\vec{G} = (V, \vec{E})$ is an oriented weighted graph with
        a positive length function $\wtp$ on $\vec{E}$ and two vertices $\source, \sink \in V$, which
        we will call \emph{source} and \emph{sink} of the oriented network respectively.
    \end{definition}
    \begin{note}
      The flow functions could be defined on the oriented networks in the similar manner
      we defined on the non-oriented networks.
    \end{note}
    Suppose $\net = (V, E, \wtp, \source, \sink)$ is a network and $\flow$ is a skew-symmetric function defined
    on $\net$.
    Naturally, we might instead consider an oriented network $\onet = (V, \vec{E}, \wtp, \source, \sink)$ and a
      positive flow function $\flowpos: \vec{E} \to \mathbb{R}^{+}$, where
      the set of vertices $V$, $\source$ and $\sink$ vertices are the same.
    The length function $\wtp$ is preserved for the oriented edges on the graph $\vec{G}$ in a trivial way.
    We establish a direction of the edge $(uv)$ as follows:
      $(uv) \in \vec{E}$ if $\flow(u, v) \geq 0$, and $(vu) \in \vec{E}$ otherwise
    This way only one of the edges $(uv)$ and $(vu)$ is present in the graph $\vec{G} = (V, \vec{E})$.
    Also we set the positive flow function $\flowpos: E \to \mathbb{R}^{+}$ so that
      for any edge $\vec{e} = (uv) \in \vec{E}$
    \begin{align*}
      &\flowpos(u v) = \lvert\flow(u,v)\rvert,
    \end{align*}
    The total flow functions $d_\flowpos$, $d^{+}_\flowpos$, $d^{-}_\flowpos$ do not change their value and could be written as
    \begin{align*}
      &d^{+}_{\flowpos}(v) = \sum_{u \in \eout(v)} \flowpos(vu),\\
      &d^{-}_{\flowpos}(v) = \sum_{u \in \ein(v)} \flowpos(uv),\\
      &d_{\flowpos}(v) = d^{+}_\flowpos(v) - d^{-}_\flowpos(v).
    \end{align*}
    Sometimes we will omit the flow from the notation.
    \begin{definition}
      The oriented network $\onet$ is called an \emph{orientation} of the network $\net$.
      For the positive flow function $\flowpos$ we will exploit the same term:
        $\flowpos$ is an \emph{orientation} of the flow $\flow$.
    \end{definition}
    \begin{remark}
      As shown, the flow functions on the networks and the positive flow functions on the oriented networks
        are interchangeable and describe the same object.
      The notion of the direction of the positive flow over the particular edge $(uv)$ of the oriented network
        is incorporated into the sign of the flow function on the same edge $(uv)$ of the non-oriented network.
    \end{remark}
    \begin{definition}
      Consider a network $\net = (G, \wtp, \source, \sink)$ such that
        the degree of each vertex in $V \setminus \{\source, \sink\} $ is finite,
        and the length of each edge incident to source or to sink is equal to one.
      Also we demand that the vertices $\source$ and $\sink$ are connected by the finite path.
      We will call such network a \emph{B-network}.
    \end{definition}
    Now we are ready to continue with the linear summation method problem.
    Our aim is to build up a B-network from the graph $B(\fsys)$.
    We plan to construct the network $\net(\fsys) = (V, E, \wtp, \source, \sink)$,
      length function $\wtp: E \to \mathbb{R}^{+}$ and a real skew-symmetric flow function $\flow: V \times V \to \mathbb{R}$.
    Firstly we incorporate all the vertices of the graph $B(\fsys)$ into the network $\net(\fsys)$.
    The vertex set of $\net(\fsys)$ will be a superset of the vertex set of $B(\fsys)$,
      so we will continue referring to the vertices as the vertices from
      the \emph{left} part of the graph and the vertices from the \emph{right} part of the graph.
    We add all the edges from the graph $B(\fsys)$ to the network $\net(\fsys)$ as well.
    We set the flow and the length functions on such edge $e = (v_l v_r)$ as follows:
    \begin{align*}
      &\flow(v_l, v_r) = T_{lr} \inner{f^*_r}{e_l},\\
      &\flow(v_r, v_l) = T_{lr} \inner{f_l}{e_r} = -\flow(v_l, v_r),\\
      &\wtp(e) = \lvert \wt(v_l, v_r) \rvert =  \lvert\inner{f_l}{e_r}\rvert^{-1}.
    \end{align*}
    \begin{note}
      Evidently on this kind of edges the flow function $\flow$ agrees with the function $\flowsgn$
        we examined a few paragraphs before.
    \end{note}

    Now we add the source vertex $\source$ and the sink vertex $\sink$ to the constructed graph.
    Suppose we have enumerated the vertices from the left part of the graph, for instance $\seq{l}$.
    Then for each $k > 0$ we connect the vertex $\source$ and the $l_k$ vertex with
      the edge $e_k = (\source l_k)$, and set the flow function:
    \begin{align*}
      &\flow(l_k, \source) = T_{l_k l_k},\\
      &\flow(\source, l_k) = -T_{l_k l_k}.
    \end{align*}
    Also we set the length equal to one for such edges: $\wtp(e_k) = 1$.
    As we added the edges $\seq{e}$, the flow became \emph{preserved} at each vertex of the left part of the network $\net(\fsys)$.

    In the similar manner we will transform the right part of the graph.
    Assuming we have the vertices from the right part of the graph $B(\fsys)$ in the form of the sequence $\seq{r}$,
      for each $k > 0$ we connect the $r_k$ vertex to the $\sink$ vertex with the edge $e'_k=(r_k \sink)$
      and set the flow $\flow$ equal to:
    \begin{align*}
      &\flow(r_k, \sink) = T_{r_k r_k},\\
      &\flow(\sink, r_k) = -T_{r_k r_k}.
    \end{align*}
    Again, we have $\wtp(e'_k) = 1$ for any $k$.

    The network $\net(\fsys)$ is built up, and it is a B-network.
    The defined function $\flow$ is a flow, since each of the vertex preserves
      $\flow$ due to the equation~\eqref{almost-flow-eqn}.
    %\begin{remark}
      %Sometimes it might be useful to consider slightly different definition of the network.
      %Instead of studying an oriented graph with a positive flow function on it we might consider
      %an undirected graph with a skew-symmetric flow function on the edges.
      %Intuitively, the direction of the flow could be expressed either via the direction of the edge
      %or with the sign of the flow function, and these two definitions describe the same objects.
      %Formally there is a isomorphism between these two types of objects.
    %\end{remark}
    \begin{remark}
      Pay your attention to the fact that the network $\net(\fsys)$
        depends only on the biorthogonal system $\fsys$ and not on the operator $T$.
      Only the flow function $flow$ depends on the operator $T$.
    \end{remark}
    What can one say about the total flow in each of the vertex of the constructed network $\net(\fsys)$?
    Due to the trick we performed the total flow became zero in each of the vertices from the \emph{left} and the \emph{right} parts.
    The total flow $d(\source)$ in the source vertex is equal to the $\sum T_{l_k l_k}$, and the total flow in the
      sink vertex is now equal to the $\sum T_{r_k r_k}$.
    Now one can see that the network $\net(\fsys)$ is $\flow$-preserving if and only if the trace of the operator $T$ is equal to
      zero.
    \begin{definition}
      Consider a network $\net = (V, E, \wtp, \source, \sink)$ and a flow function $\flow$ on it.
      We introduce a nonnegative function $\lvert\flow\rvert$ which we call the \emph{mass} of the flow $\flow$.
      \[
        \lvert\flow\rvert = \sum_{e \in E} \lvert\flow(e) \wtp(e)\rvert.
      \]
      We allow it to be equal $+\infty$ as well.
    \end{definition}
    \begin{definition}
      If $\flowpos$ is an oriented flow on the oriented network $\onet = (V,\vec{E},\wtp, \source, \sink)$ 
        we can introduce the same term for the \emph{mass} of the flow:
      \[
        \lvert\flowpos\rvert = \sum_{e \in \vec{E}} \lvert\flowpos(e) \wtp(e)\rvert.
      \]
      Though in the oriented case the flow function is always positive,
        so we are allowed to omit the modulus signs:
      \[
        \lvert\flowpos\rvert = \sum_{e \in \vec{E}} \flowpos(e) \wtp(e).
      \]
    \end{definition}
    \begin{theorem}
      \label{thm-graph-eq}
        Let $\net(\fsys) = B(\fsys, \wtp, \source, \sink)$ be a B-network constructed
          from the B-class system $\fsys = \seq{f}$.
        Then $\fsys$ admits a linear summation method if and only if
          the network $\net(\fsys)$ is $\flow$-preserving for any
          finite-mass flow $\flow$.
    \end{theorem}
    \begin{proof}
      First we briefly repeat the necessity proof we sketched previously.
      Suppose there is no summation method for the system $\seq{f}$.
      As we said before, it implies that there exists a trace class operator $T : \cal{H} \to \cal{H}$ with
      the trace equal to one, such that $\inner{Tf_n}{f_n^*} = 0$ for any $n$.
      Using the operator $T$, we were able to define a flow function $\flow(T)$ on the network
      $\net(\fsys)$.
      Notice that the constructed flow has a finite mass because the operator matrix of $T$ is finite-band and $T$ has a finite trace.
      Finally, one can acknowledge the fact that this network does not preserve the flow, since
      \[
        d(\source) + d(\sink) = \sum T_{l_k l_k} + \sum T_{r_k r_k} = Tr(T) = 1,
      \]
      thus $d(\sink) \neq -d(\source)$.
      We arrived to contradiction and the necessity is proved.

      Suppose that the system $\fsys$ admits a linear summation method.
      Assume there is also a flow $\flow$ on the network $\net(\fsys)$ such that $d(\sink) + d(\source) \neq 0$.
      In this section we are going to present an operator $T$ with a nonzero trace which annihilates all the rank-one
      operators $f_n \otimes f^*_n$, thus arriving at a contradiction with our initial assumption.
      First consider the edges incident to the source vertex.
      Having all the vertices already enumerated we will consider the vertices in the left part $v_{l_k}$.
      Recall that each vertex $v_i$ (except source and sink) matches to the basis element $e_i$.
      Assign the diagonal elements of $T$:
      \[
        T_{l_k l_k} = \flow(l_k, \source) \wtp(l_k l_k) = \flow(l_k, \source) \quad k > 0.
      \]
      Now we repeat the same procedure for the right part of the graph $\net(\fsys)$, thus having
      \[
        T_{r_k r_k} = \flow(r_k, \sink) \wtp(r_k r_k) = \flow(r_k, \sink) \quad k > 0.
      \]
      Now consider two connected vertices $v_l$, $v_r$ from the left and right part
        respectively. Assign
      \[
        T_{lr} = \flow(v_l, v_r) \wtp(v_l  v_r).
      \]
      Let all the other matrix elements of the operator matrix $T_{ij}$ be zero.
      Then observe that we got a finite-band operator matrix $T_{ij}$ with the sum of diagonal elements
      equal to one.
      Since the mass of the flow $\flow$ is finite, the $T_{ij}$ is an absolute summable sequence, considering that
        the $\ell^1$-norm of $T_{ij}$ is exactly the mass of $\flow$.
      Then the operator $T$ acquires a finite nonzero trace, since $Tr(T) = d(\sink) + d(\source)$, which is not zero
        by the assumption we made.
      Due to the fact, that the flow was preserved at each vertex of the network $\net(\fsys)$,
        we see that the operator $T$ annihilates all the rank one operators $f_n \otimes f^*_n$,
        which leads to a contradiction.
    \end{proof}

  \section{B-networks characterisation}
    Due to Theorem~\ref{thm-graph-eq} we intend to analyze the flows on the B-network
      $\net(\fsys)$ in order to understand the conditions under which a linear
      summation method exists for $\fsys$.
    In this section we are not going to address the Hilbert space setup at all,
      instead we will use only the abstract objects of the graph theory
      we used throughout the previous section.
    Also it will be more convenient for us to study \emph{oriented} networks in this section unlike we
      did in the previous one.
    Consequently the graphs, edges and networks are presumed to be oriented unless said otherwise.

    Remember some other notions from the graph theory:
    \begin{definition}
      Let $G = (V, \vec{E})$ be an oriented graph.
      A sequence of vertices $\{v_k\}_{k=1}^N$ is called a \emph{path} if each pair of consecutive vertices
        $v_k$ and $v_{k+1}$ are connected by an edge $\vec{e} = (v_k v_{k+1})$ and no edges or vertices are repeated twice in the sequence.
      The path is called a \emph{ray} when $N$ is equal to infinity.
    \end{definition}
    \begin{definition}
      Let $G$ be an oriented graph.
      A sequence of vertices $\{v_k\}_{k=1}^N$ is called a \emph{cycle} (or a simple cycle) if it is
        a path and there is an edge $\vec{e} = (v_N v_1)$ connecting the last vertex to the first vertex of the sequence.
    \end{definition}

    The main result of this section is a following
    \begin{theorem}
      \label{ray-thm}
      Let $\onet = (G, \wtp, \source, \sink)$ be an oriented B-network.
      Then there exists such a positive flow function $\flowpos: E \to \mathbb{R}^{+}$ that
      \begin{enumerate}[label=(\alph*)]
        \item the flow $\flowpos$ has a finite mass,
        \item the network $\onet$ does not preserve the flow,
      \end{enumerate}
        if and only if there exists a ray $r = \seq{r}$ in the network $\onet$, taking its start in the vertex $\source$,
          with a finite total length:
        \[
          \sum_{k=1}^\infty \wtp(v_k v_{k+1}) < \infty.
        \]
    \end{theorem}
    \begin{remark}
      \label{inner-ray-rmk}
      Notice that the definition of the B-network implies that the weight of any edge
        incident to the source or the sink vertices is equal to one.
      Suppose we found a ray $r$ described in the theorem.
      The ray has a finite length and thus it follows that only a finite number of edges $(r_k r_{k+1})$ might
        be incident either to the source or to sink vertices.
      This way the existence of the ray $r$ suggests that there also exists a ray $r^* \in V \setminus \left\{\source, \sink\right\}$.
    \end{remark}
    \begin{proof}
      Without loss of generality we might assume that $d(\sink) + d(\source)$ is precisely one.
      In order to make our proof easier we consider a slightly modified network $\onet' = (V', E', \source', \source')$.
      Namely, we merge the source vertex $\source$ with the sink vertex $\sink$ and call this a
        new source vertex $\source'$.
      This way we obtain a network $\onet'$ with a single source such that $d(\source') = 1$.
      Formally we set the sink vertex in the modified network to be the same as the source vertex: $\sink'=\source'$.
      The flow function $\flowpos$ as well as the length function $\wtp$ stay exactly the same (being defined on the edges set $E$).
      All the vertices in the graph continue preserving the flow after this procedure, except for the source vertex $\source'$
        which is now \emph{$\flowpos$-active} since its total flow $d(\source')$ equal to one.
      Thus $\onet'$ is a network with a function $\flowpos$ being a flow function as required.
      Obviously the mass of the flow does not change since we did not change the edges weights.
      Furthermore the network $\onet'$ does not preserve the flow $\flowpos$ by definition.

      Now assume we proved existence of a finite-length ray $r'$ $\onet'$, starting with $\source'$, in the modified network.
      Then since the weight of any edge incident to the source vertex is equal to one (see the remark~\ref{inner-ray-rmk})
        there is a subray of $r'$ which does not include source.
      Suppose the subray starts with some vertex $v' \in V' \setminus \source'$.
      Now consider the corresponding vertex $v \in V \setminus \left\{\source, \sink\right\}$ in the original network $\onet$.
      Due to the B-network definition $v$ is either connected to the source or to the sink vertices by a finite path.
      However by  definition of B-networks the sink is also connected to the source with the path of a finite length.
      Thus $v$ is connected to the source, and we have found the ray $r$ in $\onet$.

      On the contrary, if there is a ray $r$ in the given network $\onet$, which starts with the vertex $\source$
        then trivially there is a ray $r'$ in the modified network $\onet'$, starting from the vertex $\source$.
      From now on we will be proving the following reformulation of Theorem~\ref{ray-thm}.
      \begin{theorem*}
        Let $\onet = (G, \wtp, \source, \sink)$ be an oriented B-network such that $\source = \sink$.
        Then there exists such positive finite-mass flow $\flowpos: E \to \mathbb{R}^{+}$ that
          $\onet$ does not preserve $\flowpos$ (it means that $d(\source) \neq 0$),
          if and only if there exists a ray $r = \seq{r}$, which has a finite total length and starts from $\source$.
      \end{theorem*}
      \subsubsection*{Necessity.}
      Suppose that there is a ray of a finite total length $r=(r_1 r_2 \dots)$.
      In that case we set the resulting flow function $\flowpos(r_k r_{k+1})$ to one, creating an elusive flow
        from $\source$ to infinity. All the other edges will not carry any flow, hence the flow is preserved
        at each vertex but not preserved by the network $\onet$.
      \subsubsection*{Sufficiency.}
      In this part we are going to view this network as a rooted graph with the root at the $\source$ vertex.
      Consequently from time to time we will employ the term \emph{root vertex} and denote it by $\root = \source$.

      For a start we get rid of all the positive flow cycles in the oriented graph $G$.
      \emph{A positive flow cycle} is a cycle $C$ in $G$ such that positive flow circulates along $C$,
        meaning that for each edge $e \in C$ the flow along the edge is strictly greater than zero: $\flowpos(e) > 0$.
      %You can see an example of positive flow cycle in the Figure~\ref{positive-flow}.
      %\include{fig-pos-flow-cycle}
      In order to accomplish that, we will present a sequence of the flows $\flowposn{n}$, defined on the network $\onet$.
      At each step $n \in \mathbb{N}$ we examine a subgraph $G_n \subset G$ and present a flow function $\flowposn{n}: \onet \to \mathbb{R}^{+}$
        such that $\flowposn{n}$ is monotone: for any edge $e \in E$ the following inequality holds:
      \[
        \flowposn{n+1}(e) \leq \flowposn{n}(e),
      \]
      for any positive integer $n$.
      The main property of the subflow $\flowposn{n}$ is that there will be no positive flow cycles in the induced subgraph
      $G_n$.
      We start with the flow $\flowposn{0}:\onet \to \mathbb{R}^+$ equal to the flow $\flowpos$:
      \[
        \flowposn{0}(e) = \flowpos(e), \quad e \in E.
      \]
      The first step $n = 1$ is trivial: the graph $G_1$ contains only the root vertex, and
        the flow $\flowposn{1}$ is equal to $\flowposn{0}$:
      \[
        \flowposn{1}(e) = \flowposn{0}(e), \quad e \in E.
      \]

      In order to proceed we enumerate all vertices in the network $V = \left\{v_k\right\}_{k=1}^\infty$.
      At the step $n$ we consider the subgraph $G_n = (V_n, E_n) \subset G$, where $V_n$ is defined as $\left\{v_k\right\}_{k=1}^n$
        and the edge set $E_n$ consists of the edges from $E$ incident to $V_n$.

      Suppose we have already established the flow function $\flowposn{n}: \onet \to \mathbb{R}^{+}$ for which
        all the inequalities above are satisfied.
      We are aiming to construct the flow function $\flowposn{n+1}$.

      Define the flow function $\cal{E}_0(e): \onet \to \mathbb{R}^{+}$ as follows:
      \[
        \cal{E}_0(e) = \flowposn{n}(e).
      \]
      Let there be a simple cycle $C_1$ in the graph $G_n$ such that each edge $e \in C_1$ carries
        a positive flow: $\cal{E}_0(e) > 0$.
      At this point we can decrease the flow $\cal{E}_0$ on the edges of $C_1$ so that the cycle $C_1$
        ceases being a positive flow cycle, total mass of the flow does not increase, and all the other properties stay intact.
      Take the minimal value the flow function $\cal{E}_0$ attains on the edges of $C_1$:
        \[
          \min(C_1) = \min_{e \in C_1}\left(\cal{E}_0(e)\right).
        \]
      Consider an adjusted flow $\cal{E}_1$:
      \begin{equation*}
        \cal{E}_1(e) =
        \begin{cases}
          \cal{E}_0(e) - \min(C_1) \quad \text{if } e \in C_1,\\
          \cal{E}_0(e) \quad \text{otherwise}.
        \end{cases}
      \end{equation*}
      Since $C_1$ is a cycle, we reduced the flow $\cal{E}_0$ on each edge by the same value,
        the $\cal{E}_1$ is indeed a flow function.
      After this procedure the positive flow cycle $C_1$ disappears,
        leaving us with a lesser flow than we had before this step:
      \begin{align*}
        &\cal{E}_1(e) \leq \cal{E}_0(e), \quad e \in E_n.
      \end{align*}
      In this manner we remove all the positive flow cycles from the finite graph $G_n$.
      It is achievable since at each step we turn at least one edge into a zero-flow edge (such edge $e$ that $\cal{E}_0(e) = 0$).

      Suppose we removed $K$ positive flow cycles in total from the graph $G_n$.
      Then set the flow $\flowposn{n+1}$ equal to the final flow function $\cal{E}_K$:
      \[
        \flowposn{n+1} = \cal{E}_K.
      \]
      We have
      \begin{align*}
        &\flowposn{n+1}(e) \leq \flowposn{n}(e) \leq \flowpos(e)
      \end{align*}
        for each edge $e \in E$.

      Consider now the preflow function $\preflow$ defined as a pointwise limit of $\flowposn{n}$:
      \[
        \preflow(e) = \lim_{n \to \infty} \flowposn{n}(e)
      \]
        for each $e \in E$.
      The described pointwise limit exists since for each edge $e$ the sequence $\flowposn{n}(e)$ is decreasing and bounded below.
      \begin{prop}
        The preflow $\preflow$ is a flow such that $d_{\preflow}(\root) = d_{\flowpos}(\root)$.
      \end{prop}
      \begin{proof}
        Obviously for each $n$ the function $\flowposn{n}$ is a flow since we do not affect the total flow each time we remove a positive flow cycle.

        Now we need to obtain the same for the limit case.
        Firstly, look at the non-root vertex $v \neq \root$.
        Since there are finite number of edges in $E$ incident with $v$, the limit of
          a finite sum $d_{\flowposn{n}}(v)$ is equal to $d_{\preflow}(v)$.
        The vertex $v$ is not a root, so $d_{\flowposn{n}}(v) = 0$ for any $n$, and so the limit $d_{\preflow}(v)$ is equal to zero as well.
        Conclusively, the function $\preflow$ is a flow on the network $\onet$.

        Secondly, consider the root vertex $\root$.
        Notice that
        \[
          d_{\flowposn{n}}(\root) \overset{\mathit{def}}{=} \sum_{\eout(\root)} \flowposn{n}(e) - \sum_{\ein(\root)} \flowposn{n}(e).
        \]
        Since the sequence $\{\flowposn{n}(e)\}$ is decreasing and bounded from below,
          the quantity $d_{\preflow}(\root)=\sum_{\eout(\root)} \preflow(e) - \sum_{\ein(\root)} \preflow(e)$ is defined correctly.
        Because $d_{\flowposn{n}}(\root)$ is equal to $d_\flowpos(\root)$ for any $n$ due to the given algorithm, we have
        \[
          d_\preflow(\root) = \lim_{n \to \infty} d_{\flowposn{n}}(\root) = d_\flowpos(\root).
        \]
      \end{proof}
      \begin{prop}
        Consider the flow function $\preflow$ on the network $\onet$.
        Then there are no positive flow cycles of $\preflow$.
      \end{prop}
      \begin{proof}
        Assume the contrary: there is some cycle $C$ such that $\preflow(e) > 0$ for
          each edge $e \in C$.
        Obviously there exists such $n$ that the cycle $C$ lies within the graph $G_n$.
        Since on each step $k$ we reduced the flow $\flowposn{k}$, at the step $n$
          the cycle $C$ was a positive flow cycle as well: $\flowposn{n}(e) > 0$ for each edge $e \in C$.
        But there could be no positive flow cycles in $G_n$ at the end of the step $n$ according to our procedure.
        That is a contradiction.
      \end{proof}

      Suppose that the flow $\flowpos$ contains no positive flow cycles in the first place.
      Also we remove the edges of the network $\onet$ for which the flow $\flowpos$ equals zero.

      \subsection{Main construction}
      We are going to need a few definitions in order to proceed with the proof of the theorem.
      \begin{definition}
        Let $G = (V, \vec{E},\wtp, \root)$ be a weighted directed graph with a positive
          length function $\wtp$ defined on $\vec{E}$ and a root vertex $\root \in V$.
        Then $\gpaths(u, v)$ denotes a set of paths from vertex $u$ to vertex $v$ in the graph $G$.
        Sometimes we will omit the first argument and then we refer to the paths from the root vertex
          $\gpaths(v) = \gpaths(\root, v)$.
        Also we expand this notion onto the vertices sets: $\gpaths(U,V)$ is a set of paths
          from the set of vertices $U$ to the set of vertices $V$ in the graph $G$.
      \end{definition}
      Below we introduce a special root-distance function $\gfi$:
      \begin{definition}
        The function $\gfi: \gpaths \to \mathbb{R}^{+}$ is settled as follows:
        \[
          \gfi(p) = \sum_{e \in p} \wtp(e).
        \]
        We extend this function to take values on the set of the vertices $\gfi: V \to \mathbb{R}^{+}$ in such a fashion:
        \[
          \gfi(v) = \inf_{\gpaths(v)} \gfi(p).
        \]
      \end{definition}
      \begin{remark}
        Our ambition in the following paragraphs is to provide an estimate on the values of the distance function $\gfi$ on any vertex $v$
          located ''far'' from $\root$, namely for any integer $N > 0$ we are to provide $M > 0$ such that
          for any $v$ satisfying $\displaystyle\inf_{p \in \gpaths(v)} \#\left\{ e \mid e \in p\right\} > N$, one has $\gfi(v) < M$.
      \end{remark}

      %We are about to put up the main construction of the proof.
      %In a few moments it will become apparent why we did so.
      %\begin{note}
      %  Essentially our construction is based on a breadth-first-search in the infinite graph $G$,
      %    so $V_n = V_{n-1} \cup l_n$ where $l_n$ is all the vertices in the neighborhood of the subgraph $V_{n-1}$
      %    in the graph $G$:
      %    \[
      %      l_n = \left\{v \in G \setminus V_n \mid \text{there exists an edge $(uv) \in E$ for some $u \in V_{n-1}$} \right\}.
      %    \]
      %  Define the subgraph $L_n$ as the graph with the vertex set $l_n$.
      %  Also $L_n$ will incorporate all the edges connecting the graph $G_{n-1}$ and the vertices $l_n$.
      % We will refer to the subgraph $L_n$ as the \emph{$n$-th layer} of the graph $G$.
      %  See the figure xxx.
      %\end{note}
      The construction is based on the breadth-first search in the infinite graph $G$.
      We are going to define \emph{finite} subgraphs $G_n = (V_n, E_n)$ of the network $\onet$ such that $G_{n-1} \subset G_{n}$ for each $n > 1$.
      We denote the vertex set difference with $L_n = V_n \setminus V_{n-1}$.
      Besides, we are going to establish a sequence of the positive preflow functions $\flowposn{n}: E_n \to \mathbb{R}^{+}$,
        pertaining the following properties:
        \begin{enumerate}[label=\textbf{P\arabic*}]
          \item \label{p1} $\flowposn{n}$ is increasing:
            one has $\flowposn{n+1}(e) \geq \flowposn{n}(e)$ for each $e \in E_n$,
          \item \label{p2} $\flowposn{n}$ is dominated by $\flowpos$:
            one has $\flowposn{n}(e) \leq \flowpos(e)$ for each $e \in E_n$,
          \item \label{p3} the total flow of $\flowposn{n}$ is equal to one at the root vertex: $d_{\flowposn{n}}(\root) = 1$,
          \item \label{p4} the total flow of $\flowposn{n}$ is equal to zero at any non-root vertex
            $v \in G_{n-1}\setminus \left\{\root\right\}$: $d_{\flowposn{n}}(v) = 0$ for any $n > 1$,
          \item \label{p5} the total flow of $\flowposn{n}$
            of the vertex $v \in L_n$ is negative: $d_{\flowposn{n}}(v) = -d^{-}_{\flowposn{n}}(v) < 0$.
        \end{enumerate}
      First of all we scale the flow function $\flowpos$: suppose the total outgoing flow of the root vertex $\root$ is strictly greater than one:
        $d^{+}_{\flowpos}(\root) > 1$.
      We are going to need this assumption at the first step.

      \subsubsection*{Constructing graphs $G_n$}
      Let $G_0$ be the trivial subgraph containing the root vertex only: $G_0 = \left\{\root\right\}$.
      At the first step we build the graph $G_1$.
      %\begin{note}
      %  This is kind a delicate part of the whole proof since that is the place where
      %    we are possibly dealing with the only vertex of infinite degree in the graph $G$~--- the root vertex $\root$.
      %\end{note}
      We choose such set of the edges $E_1 \subseteq \eout(\root)$ that the total flow on this set is equal to one:
      \[
        \sum_{e \in E_1} \flowpos(e) = 1.
      \]
      It is possible since $d^{+}_{\flowpos}(\root) > 1$.

      Then we define the \emph{first layer} $L_1$ as the ends of the edges $E_1$
      \[
        L_1 = \ter(E_1).
      \]
      Along with the graph $G_1 = (V_0 \cup L_1, E_1)$ we appoint the preflow function $\flowposn{1}: E_1 \to \mathbb{R}^{+}$ in a trivial way:
      \[
        \flowposn{1}(e) = \flowpos(e)
      \]
        for each $e \in E_1$.
      \begin{prop}
        The preflow $\flowposn{1}$ satisfies all of the properties~\ref{p1}--\ref{p5}.
      \end{prop}
      \begin{proof}
        The properties~\ref{p1}--\ref{p4} are trivial and left to the reader.

        \noindent \ref{p5}. We included the ends of the $E_1$ edges without any additional edges.
        Thus each vertex in $L_1$ has only incoming edges which makes their
          total flow strictly negative (recall that we removed all zero-flow edges).
      \end{proof}
      \begin{note}
        We dealt with the typically infinite degree of the root vertex by abandoning some of the children of the root.
        \alex{a figure of the first layer (infinite degree!)}
        We need the graph $G_n$ to be finite since this way we could analyze the $\gfi$ function without trouble.
      \end{note}
      For each further step $n > 1$ the construction will be similar.
      Suppose that $G_{n-1}$, $L_{n-1}$ and the preflow function $\flowposn{n-1}$ are already established.
      Consider the outgoing edges of the vertex $v \in L_{n-1}$.
      Some of them might lead to some new vertices which do not belong to $G_{n-1}$.
      Such edges we will call by $\efor_n$:
      \[
        \efor_n = \Big\{ e = (uv) \mid u \in L_{n-1} \text{ and } v \notin G_{n-1}\Big\}.
      \]
      Others might lead to the already visited vertices of $G$, namely the ones residing in the graph $G_{n-1}$.
      Such edges we will address as the \emph{back} edges of $L_{n-1}$ and denote them by $\eback_n$:
      \[
        \eback_n = \Big\{e = (us) \mid u \in L_{n-1} \text{ and } s \in G_{n-1}\Big\}.
      \]
      \begin{remark}
        Pay your attention that a \emph{back} edge could never lead to the root vertex since that
          would yield an existence of a positive flow cycle for the flow function $\flowpos$.
      \end{remark}
      We define the vertex set $L_n$ as follows: $L_n = \ter(\efor_n)$.
      Accordingly, we prescribe the graph $G_n$ as
      \[
        G_n = (V_{n-1} \cup L_n, E_{n-1} \cup \eback_n \cup \efor_n).
      \]
      Thus the graph $G_n$ is constructed.
      \alex{a figure of the $n$-th layer construction}

      \subsubsection*{Setting a preflow function.}

      Here we split the procedure in two steps.
      Take the preflow function $\cal{G}: E_n \to \mathbb{R}^{+}$ initially equal to $\flowposn{n-1}$ on $E_{n-1}$:
      \[
        \cal{G}(e) = \flowposn{n-1}, \quad e \in E_{n-1},
      \]
      and zero otherwise.
      We are going to extrapolate it onto the $E_n$ (step one) and then change it gradually in order
        to satisfy all the properties from~\ref{p1} to~\ref{p5} (step two).
      Notice how all the vertices except the root and the last layer $L_{n-1}$ are $\cal{G}$-preserving.
      The root is $\cal{G}$-deficient and the $(n-1)$-th layer is currently $\cal{G}$-active.
      At the first step our desire is to expand the flow-preserving property~\ref{p4} onto the $L_{n-1}$.
      In order to do such expansion we will propagate the flow $\cal{G}$, incoming to the $(n-1)$-th layer, one edge further.

      Namely, consider the vertex $u \in L_{n-1}$.
      Since $d_{\cal{G}}^{-}(u) \leq d_{\flowpos}^{-}(u)$ (by~\ref{p2}),
        we are able to set the flow $\cal{G}$ on the outgoing edges of $u$ in such a way that:
      \begin{enumerate}[label=\textbf{(\roman*)}]
        \item\label{posprop} each outgoing edge has a positive flow: $\cal{G}(e) > 0$ for any $e \in \eout(u)$,
        \item $\cal{G}$ is still bounded from above:
          $\cal{G}(e) \leq \flowpos(e), \quad e \in \eout(u)$,
        \item the vertex $u \in L_{n-1}$ becomes $\cal{G}$-preserving.
      \end{enumerate}
      \begin{note}
        Literally, here we are pushing the flow out of the vertex $u \in L_{n-1}$ and spreading it among all the outgoing edges
          $\eout_{G_n}(u) = \eout_G(u)$.
        Since the preflow $\cal{G}$ is bounded above by the flow $\flowpos$ which is preserved at each vertex of the graph $G$,
          particularly, at the vertex $u$, it is trivial that such expansion exists.
      \end{note}
      So if we had no back edges, the function $\cal{G}$ would be our next preflow function $\flowposn{n}$, and this step would be accomplished,
        since all the properties~\ref{p1}--\ref{p5} would be complied by $\cal{G}$.
      However we ought to solve the problem we created while pushing the flow from the $(n-1)$-th layer via the back edges.
      Notice that the end vertices of such edges $\eback_{n}$ now became $\cal{G}$-active, since for such vertices
        the total incoming flow now exceeds the total outgoing flow. \alex{a figure of a back edge making some inner vertex non-preserving, unite with the figure of n-th layer?}
      Thus we have reached the step number two, when we are going to carry out the \emph{relaxation} procedure
        in order to alleviate those $\cal{G}$-active vertices created by the newly introduced back edges into the graph $G_{n-1}$.

      \begin{definition*}
        Denote $\gnpaths(\makebox[1ex]{$\cdot$}, \makebox[1ex]{$\cdot$}) = \cal{P}_{G_n}(\makebox[1ex]{$\cdot$},\makebox[1ex]{$\cdot$})$.
      \end{definition*}
      Consider a $\cal{G}$-active vertex $s \in \ter(\eback_n)$ such that $d_{\cal{G}}^{-}(s) > d_{\cal{G}}^{+}(s)$.
      Let there exists such path $p \in \gnpaths(s, L_n)$, connecting the vertex $s$ and the $n$-th layer, that
        the preflow $\cal{G}$ could be increased along this path by some constant
        $\delta \leq d_{\cal{G}}^{-}(s) - d_{\cal{G}}^{+}(s) = -d_{\cal{G}}(s)$.
      \begin{definition}
        Such path $p$ will be referred as a \emph{$\cal{G}$-augmenting} path for the vertex $s$.
      \end{definition}
      Obviously for this path each edge $e \in p$ admits the inequality $\cal{G}(e) < \flowpos(e)$.
      This way, the possible $\delta$ does not exceed $\delta_{max}=\min\limits_{e \in p}(\flowpos(e) - \cal{G}(e))$.
      \begin{definition}
        The edge $e$ is called a \emph{$\cal{G}$-saturated} edge if $\cal{G}(e) = \flowpos(e)$.
      \end{definition}
      \begin{definition}
        The path $p$ is called \emph{$\cal{G}$-saturated} if there exists such an edge $e \in p$ that $e$ is $\cal{G}$-saturated.
      \end{definition}
      For each path $p \in \gnpaths(s, L_n)$ we raise the preflow $\cal{G}$ at every edge of the path $p$
      by $\delta > 0$.
      The described procedure we call as \emph{$\cal{G}$-relaxation} of the vertex $s$.
      Strictly speaking, the {$\cal{G}$-relaxation}
        of the vertex $s$ means reduction of the excess of the flow $\cal{G}$ in the vertex $s$.
      Our purpose is to relax the vertex $s$, transforming it into a $\cal{G}$-preserving vertex.

      If $\delta_{max} \geq -d_{\cal{G}}(s)$ then \emph{pushing} the flow along the path $p$ of the size precisely $-d_{\cal{G}}(s)$
        will be enough to make the vertex $s$ preserving the preflow $\cal{G}$
        (\emph{pushing} the flow $C \in \mathbb{R}$ along the path $p$ means raising the flow $\cal{G}$ at each edge $e \in p$:
        $\cal{G}'(e) = \cal{G}(e) + C$).
      On the other hand if $\delta_{max} < -d_{\cal{G}}(s)$ then pushing the flow of the size $\delta_{max}$ along the path $p$ is not enough
        in order to make the vertex $\cal{G}$-preserving.
      In this case we push the flow $\delta_{max}$ along the path $p$ and look for the other augmenting paths in $\gnpaths(s, L_n)$.
      We will repeat the outlined procedure until we finally relax the vertex $s$.
      \begin{prop}
        The vertex $s$ will be $\cal{G}$-relaxed in a finite number of steps.
      \end{prop}
      \begin{proof}
        Firstly, we have a finite graph $G_{n}$, and so there are only a finite number of paths in the $\gnpaths(s, L_n)$.
        Secondly, each time we push the flow along the augmenting path $p$ either we successfully relax the vertex $s$
          or we saturate at least one edge lying on the chosen path $p$.
        Since the number of the edges is finite the procedure halts after a finite number of steps.

        Suppose that there is a non-root vertex $s$ that is not yet relaxed.
        Examine the set of vertices $S \subseteq G_n$ which are reachable by non-saturated paths from the vertex $s$
        Obviously $S \cap L_n = \emptyset$.
        Now consider the subgraph $U \subseteq G_n$:
        \[
          U = \bigcup\big\{p \in \gnpaths(s, S) \mid \text{$p$ is not $\cal{G}$-saturated}\big\},
        \]
        \begin{lemma}
          Any edge $e \in \eout(U)$ is saturated.
        \end{lemma}
        \begin{proof}
          There is no root vertex in $U$ and for each non-root vertex $v \in G_n$ we have
          $\eout_{G_n}(v) = \eout_G(v)$, consequently $e$ is in the graph $G_n$.
          If $e$ was not saturated then we could trivially find another path in $\gnpaths(s, S)$ belonging to $U$, which would imply that
            $e$ is in $U$ which is impossible.
          Therefore $e$ is saturated.
        \end{proof}
        %Such subgraph has no outgoing non-saturated edges in the graph $G_n$.
        %It also does not have outgoing non-saturated edges in the whole graph $G$ since all the outgoing edges it had in $G$
        %  ought to have been appended to the graph $G_n$.
        For a vertex $u \in S$ we see that $d_{\cal{G}}(u) = d^{+}_{\cal{G}}(u) - d^{-}_{\cal{G}}(u) \leq 0$, because
          the only $\cal{G}$-deficient vertex in the graph $G_n$ is the root vertex $\root$, which is not in $U$.
        Also for the vertex $s$ itself we have a strict inequality $d_{\cal{G}}(s) < 0$ since it is not relaxed by our assumption.
        It is clear now that the quantity $D = \displaystyle\sum_{u \in U} d_{\cal{G}}(u)$ is strictly less than zero.
        On the other hand
        \[
        \begin{split}
          D &= \mathlarger\sum_{u \in U} \Big(d^{+}_{\cal{G}}(u) - d^{-}_{\cal{G}}(u)\Big)
          = \mathlarger{\smashoperator{\sum_{\eout_{G_n}(U)}}} \cal{G}(e) - \mathlarger{\smashoperator{\sum_{\ein_{G_n}(U)}}} \cal{G}(e) = \\
          &= \mathlarger{\smashoperator{\sum_{\eout_{G}(U)}}} \flowpos(e) - \mathlarger{\smashoperator{\sum_{\ein_{G_n}(U)}}} \cal{G}(e)
            \overset{\ref{p2}}{\geq} \mathlarger{\smashoperator{\sum_{\eout_G(U)}}} \flowpos(e) - \mathlarger{\smashoperator{\sum_{\ein_{G_n}(U)}}} \flowpos(e) 
            \overset{G_n \subset G} \geq \\
          &\geq \mathlarger{\smashoperator{\sum_{\eout_G(U)}}} \flowpos(e) - \mathlarger{\smashoperator{\sum_{\ein_{G}(U)}}} \flowpos(e) = 0.
        \end{split}
      \]
        So we deduced that $0 > D \geq 0$, and that is a contradiction.
      \end{proof}
      It follows that we relax all the vertices in $\eback_n$.
      Conclusively, we set the preflow function $\flowposn{n}$ equal to the $\cal{G}$ we got after relaxations.
      \begin{prop}
        The properties~\ref{p1}--\ref{p5} are satisfied for the resulting preflow function $\flowposn{n}$ on the network $\onet_n = (G_n, \wtp, \root)$.
      \end{prop}
      \begin{proof}
        The monotonicity property~\ref{p1} is true since during the relaxation step $n$ we
          only increased the flow on the edges of the graph $G_n$.

        The boundedness property~\ref{p2} is also true since we chose the flow values in such a way
          that the bound $\flowposn{n}(e) \leq \flowpos(e)$ holds for each edge $e\in G_n$.

        The root vertex was not be affected during the step $n > 1$, so~\ref{p3} holds.

        The flow $\cal{G}$ was redesigned in such fashion that each non-root vertex $v \in G_{n} \setminus 
          \left(L_n \cup \{\root\}\right)$ became $\cal{G}$-preserving.
        This checks the property~\ref{p4}.

        Finally, due to the first step property~\ref{posprop} and the fact that
        any vertex in $L_n$ has only incoming edges in the graph $G_n$, we prove the property~\ref{p5}.
      \end{proof}
      The flow construction is completed.
      Now we would like to introduce some simpler notations.
      \begin{definition}
        The function $\phi_n: G_n \to \mathbb{R}^{+}$ will stand for the distance function on the $n$-th graph $G_n$:
          $\phi_n(v) = \phi_{G_n}(v)$.
      \end{definition}
      Likewise we define the functions $d_n$, $d^{-}_n$, $d^{+}_n$.
      \begin{lemma}
        For each $G_n$ ($n > 1$) the following inequality holds.
        \begin{equation}
          \label{main-ineq}
          \sum_{v\in L_n}d_{n}^{-}(v) \phi_n(v) \leq \sum_{e \in E_n} \wtp(e) \flowpos(e).
        \end{equation}
      \end{lemma}
      \begin{proof}
        First denote the left hand side by $LS$
        \[
          LS = \sum\limits_{v \in L_n} d_n^{-}(v) \phi_n(v).
        \]
        Since $\phi_n(\root) = 0$ and for all vertices $u \in G_{n} \setminus \left(L_n \cup \{\root\}\right)$
          we have $d_n(u) = 0$ we could study the sum over the whole $G_n$ instead of $L_n$.

        Also recall that $d_n^{+}(v) = 0$ for each vertex $v \in L_n$, hence $d_n(v) = -d_n^{-}(v)$ whenever $v$ is in the $n$-th layer.

        Next we regroup the summation in order to have a sum over the edges of $G_n$, not vertices:
        \begin{align*}
          LS = \sum\limits_{v \in L_n} d_n^{-}(v) \phi_n(v) = -\sum\limits_{v \in V_n} d_n(v) \phi_n(v) =\\
          =-\sum_{v \in V_n} \left(\sum_{\eout(v)} \flowposn{n}(e) - \sum_{\ein(v)}\flowposn{n}(e) \right) \phi_n(v)=\\
          =\sum_{(vu) \in E_n} \flowposn{n}(vu) \big(\phi_n(u) - \phi_n(v)\big).
        \end{align*}
        Let $(vu)$ be an edge in $E_n$. Recall that
        \[
          \phi_n(u) \overset{\mathit{def}}{=} \inf_{p \in \gnpaths(u)} \phi_n(p) \leq \phi_n(v) + \wtp(vu).
        \]
        It implies that
        \[
          LS\leq \sum_{(vu) \in E_n} \flowposn{n}(vu) \wtp(vu) = \sum_{e \in E_n} \flowposn{n}(e) \wtp(e).
        \]
        Due to the property~\ref{p2} we get the following:
        \[
          LS\leq \sum_{e \in E_n} \flowposn{n}(e) \wtp(e) \leq \sum_{e \in E_n} \flowpos(e) \wtp(e).
        \]
        The inequality is proven.
      \end{proof}
      Due to this lemma the following fact turns out transparent.
      \begin{prop}
        For each $n > 0$ there exists such vertex $r_n \in L_n$ that $\phi_n(r_n) \leq \lvert\flowpos\rvert$.
      \end{prop}
      \begin{proof}
        Consider the lemma we have just proven.
        Again we have $LS$ standing for the left hand side of the inequality~\eqref{main-ineq}.
        Remark that
        \[
          LS = \sum_{v \in L_n}d^{-}_n(v) \phi_n(v) \geq \min_{v \in L_n}\phi_n(v) \sum_{v \in L_n} d^{-}_n(v).
        \]
        Since $\sum\limits_{v \in L_n} d^{-}_n(v)$ is the total amount of the flow incoming to the deepest layer $L_n$, and the only
          active vertex in $G_n$ is the root, which produces the flow which size is precisely equal to $1$, the following is true:
        \[
          \sum_{v \in L_n} d^{-}_n(v) = d^{+}_n(\root) = 1.
        \]
        The latter yields
        \[
          LS \geq \min_{L_n} \phi_n(v).
        \]

        Furthermore we remark that due to the~\eqref{main-ineq} the next inequality holds:
        \[
          \min_{L_n} \phi_n(v) \leq LS \leq \sum_{e \in E_n} \wtp(e) \flowpos(e) \leq \lvert\flowpos\rvert.
        \]
        Seeing that $L_n$ contains a finite number of vertices, there exists such vertex $r_n \in L_n$ that
        \[
          \phi_n(r_n) \leq \lvert\flowpos\rvert.
        \]
      \end{proof}
      \begin{prop}
        There exists such a ray $r=(r_0 r_1 r_2\dots)$, where $r_n \in L_n$ for each $n > 0$, such that $\sum\limits_{k=1}^\infty \wtp(r_{k-1}r_k) < \infty$.
      \end{prop}
      \begin{proof}
        We will seek for the ray $r$ in the graph
        \[
          \gstar = \bigcup G_n.
        \]
        Unlike $G$ this graph is locally finite which is a crucial property for our solution.
        Also we need a distance function in the graph $\gstar$:
        \[
          \phistar(v)=\phi_{\gstar}(v).
        \]
        Note that $\phi_n(v) \geq \phistar(v)$ for any $v \in G_n$ since $G_n$ is a subgraph of $\gstar$.
        Owing to the previous proposition there is always a vertex $r_n \in L_n$ that $\phi_n(r_n) \leq \lvert\flowpos\rvert$.
        Consider the set of vertices $U_n$:
        \[
          U_n= \{u \in L_n \mid \phi_n(u) \leq \lvert\flowpos\rvert\}.
        \]
        Let $\cal{P}^*$ be a set of paths $p = (p_1 p_2 \dots)$, such that for each $k > 0$ the vertex $p_k$ is in $U_k$.
        Presume $\cal{P}^*$ consists only of finite paths.
        We are going to construct the ray $r$ lying in the $\cal{P}^*$, thus arriving to a contradiction.
        We set up $r$ in such a way that for every path $p_k= (r_0 r_1 \dots r_k)$ there is an infinite number of paths
          in $\cal{P}^*$ which start with $p_k$.

        We start from $k = 0$.
        Trivially, we start with the root vertex: $r_0 = \root$.
        Each $U_n$ is non-empty and if a vertex $u$ belongs to $U_n$ then there always exists
          a path $p_n \in \cal{P}^*$, which belongs to $\cal{P}(u)$.
        So we have an infinite set of paths $\bigcup p_n$ starting from the root vertex $\root$.

        Suppose we have already obtained the path $p_k= (r_0 r_1\dots r_{k-1})$.
        By the assumption there is an infinite number of paths in $\cal{P}^*$ starting with the path $p_k$.
        Address these paths as $\cal{P}^*_k$.
        Let us look at the \emph{forward} edges of the vertex $r_{k-1} \in U_{k-1} \subseteq L_{k-1}$:
        \[
          \efor(r_{k-1})=\left\{(r_{k-1} u) \mid u \in L_k\right\}.
        \]
        Now consider the path $q \in \cal{P}^*_k \setminus \left\{p_k\right\}$ looking as follows.
        \[
          q=(r_0 r_1 \dots r_{k-1} \mathbf{q_k} q_{k+1} \dots),
        \]
          where $q_i$ are some other vertices.
        Evidently for such path we have the vertex $\mathbf{q_k}$ being equal to be one of the end vertices of the edges $\efor(r_{k-1})$.
        Remember that the graph $\gstar$ is locally finite and in particular the degree of the vertex $r_{k-1}$ is finite.
        Moreover the number of the paths in $\cal{P}^*_k$ is infinite, as a result of the previous construction step.
        Consequently we are able to choose such $r_k \in \efor(r_{k-1})$ that the number of paths in $\cal{P}^*_k$ starting from
          the path $p_{k+1}= (p_k r_k)$ is infinite as well.
        Finally the ray $r = (r_0 r_1 \dots) \in \cal{P}^*$ is constructed.
        The sum $\sum \wtp(r_k r_{k+1})$ is bounded since the partial sums are bounded by the values of the function $\phi_n$
         which are uniformly bounded by definition of the classes $U_n$.
      \end{proof}
      In the end we found a finite-length ray in the network $\onet$.
      Hence the implication is proved as well as the theorem itself.
    \end{proof}

  \section{Application of the B-networks criterion}
    \subsection{Application of the B-networks criterion to the Larson--Wogen example.}
      The Larson--Wogen system is outlined in the Example~\ref{lw-sys}.
      The sequences $\{f_j\}$, $\{f^*_j\}$ are biorthogonal and both are complete in $\cal{H}$ (thus $\fsys$ is an $M$-basis).
      Also due to Katavolos et al.~\cite{katavolos} the next two theorems are accurate.
      \begin{theorem}
        \label{thm-katavolos-1}
          $\fsys_{LW}$ admits a linear summation method if and only if the system is two point dense.
      \end{theorem}
      \begin{note}
        We are going to use this result in order to finish the classification of the B-class vector systems later.
      \end{note}

      \begin{theorem}
        \label{thm-katavolos-2}
      %  \begin{enumerate}[label=(\alph*)]
          %\item The system $\fsys_{LW}$ is a strong $M$-basis if and only if the following sequence
            %\begin{equation*}
            %  \mu_n = \frac{a_{n-1} a_{n-3} \dots}{a_{n} a_{n-2} \dots }
            %\end{equation*}
              %does not belong to $\ell^2$,
          $\fsys_{LW}$ admits a linear summation method when and only when
            the sequence $\left\{1/a_n\right\}_{n=1}^\infty$ does not belong to $\ell^1$.
      %  \end{enumerate}
      \end{theorem}
      We would like to present another proof of Theorem~\ref{thm-katavolos-2}, using the ideas we exposed earlier.
      \begin{prop}
        The vector system $\fsys_{LW}$ admits a linear summation method when and only when
          the sequence $\left\{1/a_n\right\}_{n=1}^\infty$ does not belong to $\ell^1$.
      \end{prop}
      \begin{proof}
        Here we will discuss the Larson--Wogen system only: $\fsys = \fsys_{LW}$.

        Notice that $\fsys$ belongs to the B-class.
        Thus $\fsys$ is applicable to Theorem~\ref{thm-graph-eq}, which asserts
          that $\fsys$ admits a linear summation method if and only if
          the network $\net(\fsys)$ is $\flow$-preserving for any
          finite-mass flow $\flow$.
        We could reformulate the conclusion in terms of \emph{oriented} networks.
        The system $\fsys$ admits a linear summation method if and only if
          the oriented network $\onet(\fsys)$ is $\flowpos$-preserving for any
          finite-mass flow $\flowpos$.
        After that we utilize Theorem~\ref{ray-thm}, which states that there exists such
          flow $\flowpos: \vec{E} \to \mathbb{R}^{+}$ with a finite mass which is not preserved in
          the network $\onet(\fsys)$
          if and only if there exists a ray $r \subseteq \onet $ originating in the $\source$ vertex,
          whose total length is bounded: $ \sum_{k=1}^\infty \wtp(v_k v_{k+1}) < \infty$.
          Hence, the system does not admit a linear summation method when and only when there is such ray $r$
            with the properties specified up above.

          How does look the ray of a finite length in the network like $\onet(\fsys)$?
          It is obvious that it cannot include infinite number of the edges incident to the
            $\source$ and $\sink$ vertices, since such edges have the length exactly one.
          Now look at the outline of the network $\onet(\fsys)$ (Figure~\ref{LW-net}).
          It clearly demonstrates that the existence of the finite-length ray in the network $\onet(\fsys)$ implies that
            the ray $r=(r_1 r_2 r_3\dots)$ has a finite length as well.
          However this ray has the length equal to $\sum \wtp(r_k r_{k+1}) = \sum 1/\lvert a_k \rvert$,
          which completes the proof.
      \end{proof}
      \pagebreak
      \begin{figure}
        \begin{center}
        \begin{tikzpicture}[thick,
                            every node/.style={draw,circle},
                            %every fit/.style={ellipse,draw,inner sep=-1pt,text width=2cm},
                            ]
          %\draw[help lines,step=9mm,gray!70] (0,-6) grid (6,0);
          \node[fill=gray,draw, xshift=-3cm, yshift=-3.5cm] (source) {$s$};
          \begin{scope}[start chain=going below,node distance=7mm]
            \foreach \i in {1,3,5,7}
            \node[lnode,on chain] (l\i) [] {$e_{\i}$};
            \node[draw=none,on chain, yshift=7mm]{$\vdots$};
          \end{scope}
          \begin{scope}[xshift=3cm,yshift=-0.5cm,start chain=going below,node distance=7mm]
            \foreach \i in {2,4,6,8}
            \node[rnode,on chain] (r\i) [] {$e_\i$};
            \node[draw=none,on chain, yshift=7mm]{$\vdots$};
          \end{scope}
          \node[xshift=6cm,yshift=-3.5cm,draw] (sink) {$t$};

          % the set U
          %\node [fit=(l1) (l5),label=above:\emph{left}] {};
          % the set V
          %\node [fit=(r6) (r9),label=above:\emph{right}] {};

          % the edges
          \foreach [evaluate={\k=int(\i*2 + 1)}] \i in {0,...,3}
          \draw(source)--(l\k);
          \foreach [evaluate={\k=int(\i*2 + 2)}] \i in {0,...,3}
          \draw(sink)--(r\k);
          \draw (l1) -- (r2);
          \draw (r2) -- (l3);
          \draw (l3) -- (r4);
          \draw (r4) -- (l5);
          \draw (l5) -- (r6);
          \draw (r6) -- (l7);
          \draw (l7) -- (r8);
        \end{tikzpicture}
        \caption{The network $\net$ built based on the LW-system $\fsys_{LW}$} \label{LW-net}
        \end{center}
      \end{figure}

    \section{Application of the B-networks criterion to the B-class vector systems}
      In this section our aim is to apply the knowledge we gathered in the previous section to
      the net $\net(\fsys)$, we constructed in Section~\ref{fsys2graphs}.

      First of all we are going to make a few comments on Theorem~\ref{thm-katavolos-1}.
      \begin{remark}
        Theorem~\ref{thm-katavolos-1} states that $\fsys_{LW}$ does not possess a linear summation method,
          when and only when it is not two point dense.
        The definition~\ref{2pd} implies that the system $\fsys$ is not two point dense
          if and only if there exists an operator $T$ of rank $2$
          which has a nonzero trace and annihilates all the rank one operators $f_k \otimes f^*_k$.
          (see the proof of Theorem 2.2 in the paper~\cite{katavolos}).
        Moreover, we know the condition for the linear summation method existence, namely that
          there is no linear summation method for the LW system $\fsys_{LW}$ if and only if $\left\{1/a_k\right\}$
          is a summable sequence.
        We can conclude from these facts that the following lemma holds.
        \begin{lemma}
          \label{as-lemma}
          Whenever the sequence $\left\{\wtp_k = 1/a_k\right\}$ is summable,
            it is possible to define a two-dimensional operator $T$ in such a form:
          \begin{align*}
            &T_{11} = 1,\\
            &T_{k\, k+1} = \wtp_k,
          \end{align*}
          while the other entries $T_{ij}$ are equal to zero.
        \end{lemma}
      \end{remark}
      Now we are ready to prove the final result.
      \begin{theorem}
        \label{density-thm}
        Let $\fsys$ be a B-class vector system.
        Then $\fsys$ is two point dense when and only when $\fsys$ admits a linear summation method.
      \end{theorem}
      \begin{proof}
        The necessity is trivial for the two point density property is weaker than the existence of the linear summation method for $\fsys$.

        Now let us prove the sufficiency.
        Pretend $\fsys$ does not admit a linear summation method.
        Let $\onet(\fsys) = (G, \wtp, \source, \sink)$ be an orientation of the network $\net(\fsys)$.
        Applying Theorem~\ref{thm-graph-eq} and then Theorem~\ref{ray-thm} to the network $\onet(\fsys)$
          we recognize that there is a finite-length ray $r \subseteq \onet$ taking its origin
          in the source vertex $\source$.
        Suppose $r = \seq{r}$ such that $r_0 = \source$.

        Consider such a flow $\flowpos$ such that $\flowpos(r_k r_{k+1}) = 1$ and $\flowpos(e) = 0$ for any $e \not \in r$.
        Then the network $\onet(\fsys)$ is not $\flowpos$-preserving (see Theorem~\ref{ray-thm}).

        Next our plan is to reconstruct the operator $T$ from the flow $\flowpos$.

        Consider the basis vectors $e_{s_k}$ which correspond to the vertices $r_k$.
        Split the Hilbert space $\cal{H}$ in two smaller subspaces $\cal{H} = \cal{H}_1 \oplus \cal{H}_2$,
          such that $\cal{H}_1 = \bigoplus\limits_k e_{s_k}$.

        Consequently we put the operator $T$ to zero on the $\cal{H}_2$: $T\vert_{\cal{H}_2} = 0$.
        We now reuse the $e_k$ notation for the basis vectors $e_{s_k}$ (since we work now in the subspace $\cal{H}_1$,
          such substitute is feasible).

        We are meaning to look for a two-dimensional operator $T'$ as follows.
        \begin{align*}
          &T'_{11} = 1,\\
          &T'_{k k+1} = \wtp(r_k r_{k+1}) \flowpos(r_k r_{k+1}) = \wtp(r_k r_{k+1}),
        \end{align*}
          while the other elements of $T'$ are zero.

        Since the ray $r$ has a finite length, $\wtp(r_k r_{k+1})$ is a summable sequence.
        Due to Lemma~\ref{as-lemma} there exists a two-dimensional operator $T'$, which satisfies the equalities above.
        And so we set up the trace class operator $T$, which corresponds to the flow $\flowpos$ and thus annihilates all the rank one
          subalgebra of $\cal{A}$.
        Therefore the system is not two point dense.
    \end{proof}
    \begin{remark}
      Concerning the linear summation method property, the last theorem reveals that the B-class vector systems
        admit the same criterion as the Larson--Wogen system.
      Furthermore the Larson--Wogen system is to a certain extent a canonical element of this class,
        since the corresponding bipartite graph $B(\cal{F}_{LW})$
        is a ray itself (see Figure~\ref{lw-bgraph}).
    \end{remark}
\bigskip
\include{bib}
\vspace{1em}
\noindent{\bf Keywords:} biorthogonal system, hereditary completeness, $M$-basis, linear summation method, rank one density property, two point density property.
\end{document}
